---

title: Understat-DB CLI


keywords: fastai
sidebar: home_sidebar

summary: "CLI for creating a soccer database with data from understat.com"
description: "CLI for creating a soccer database with data from understat.com"
nb_path: "nbs/cli.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/cli.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialise the app with Typer</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EnvTyper" class="doc_header"><code>class</code> <code>EnvTyper</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L24" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EnvTyper</code>(<strong><code>name</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e2870a0&gt;</code></em>, <strong><code>cls</code></strong>:<code>Optional</code>[<code>Type</code>[<code>TyperGroup</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e287250&gt;</code></em>, <strong><code>invoke_without_command</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e287460&gt;</code></em>, <strong><code>no_args_is_help</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295070&gt;</code></em>, <strong><code>subcommand_metavar</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295100&gt;</code></em>, <strong><code>chain</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295160&gt;</code></em>, <strong><code>result_callback</code></strong>:<code>Optional</code>[<code>Callable</code>[<code>Ellipsis</code>, <code>typing.Any</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e2951c0&gt;</code></em>, <strong><code>context_settings</code></strong>:<code>Optional</code>[<code>Dict</code>[<code>typing.Any</code>, <code>typing.Any</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295220&gt;</code></em>, <strong><code>callback</code></strong>:<code>Optional</code>[<code>Callable</code>[<code>Ellipsis</code>, <code>typing.Any</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295280&gt;</code></em>, <strong><code>help</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e2952e0&gt;</code></em>, <strong><code>epilog</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295340&gt;</code></em>, <strong><code>short_help</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e2953a0&gt;</code></em>, <strong><code>options_metavar</code></strong>:<code>str</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295400&gt;</code></em>, <strong><code>add_help_option</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295460&gt;</code></em>, <strong><code>hidden</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e2954c0&gt;</code></em>, <strong><code>deprecated</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295520&gt;</code></em>, <strong><code>add_completion</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>rich_markup_mode</code></strong>:<code>Literal</code>[<code>markdown</code>, <code>rich</code>, None]=<em><code>None</code></em>, <strong><code>rich_help_panel</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x17e295580&gt;</code></em>, <strong><code>pretty_exceptions_enable</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>pretty_exceptions_show_locals</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>pretty_exceptions_short</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <code>Typer</code></p>
</blockquote>
<p>Just like typer.Typer, except it loads the environment with
<code>dotenv.load_dotenv</code> before executing any command.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Migrate">Migrate<a class="anchor-link" href="#Migrate"> </a></h2><p>Migrating the database</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="migrate" class="doc_header"><code>migrate</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L71" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>migrate</code>(<strong><code>interactive</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Migrate database to the current schema (as defined in nbs/db.ipynb)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="dbt-runner">dbt runner<a class="anchor-link" href="#dbt-runner"> </a></h2><p>(Re-)build tables from base data using dbt (data-build-tool)'s (unsupported) python API</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_tables" class="doc_header"><code>build_tables</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_tables</code>(<strong><code>args</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x17e292b20&gt;</code></em>)</p>
</blockquote>
<p>Build tables from base data using dbt</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ingest">Ingest<a class="anchor-link" href="#Ingest"> </a></h2><p>Ingest base understat data and build understat tables from base data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ingest" class="doc_header"><code>ingest</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ingest</code>(<strong><code>refresh</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>leagues</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x17e292b80&gt;</code></em>, <strong><code>seasons</code></strong>:<code>List</code>[<code>int</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x17e292bb0&gt;</code></em>)</p>
</blockquote>
<p>Ingest match and shot data from Understat.com</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modelling">Modelling<a class="anchor-link" href="#Modelling"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resimulate" class="doc_header"><code>resimulate</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L210" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resimulate</code>(<strong><code>refresh</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>leagues</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x17e292c10&gt;</code></em>, <strong><code>seasons</code></strong>:<code>List</code>[<code>int</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x17e292c40&gt;</code></em>)</p>
</blockquote>
<p>Resimulate matches based on individual shot xGs</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="backtest" class="doc_header"><code>backtest</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L265" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>backtest</code>(<strong><code>refresh</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>models</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x17e292ca0&gt;</code></em>, <strong><code>league</code></strong>:<code>str</code>=<em><code>&lt;typer.models.OptionInfo object at 0x17e292cd0&gt;</code></em>, <strong><code>start_date</code></strong>:<code>str</code>=<em><code>&lt;typer.models.OptionInfo object at 0x17e292d00&gt;</code></em>)</p>
</blockquote>
<p>Fit team strength model(s) and persist to database</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>refresh</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>models</code></strong></td>
<td><code>typing.List[str]</code></td>
<td><code>&lt;typer.models.OptionInfo object at 0x17e292ca0&gt;</code></td>
<td><em>No Content</em></td>
</tr>
<tr>
<td><strong><code>league</code></strong></td>
<td><code>str</code></td>
<td><code>&lt;typer.models.OptionInfo object at 0x17e292cd0&gt;</code></td>
<td>Because there's no overlap across leagues in the understat dataset<br />just pick one league at a time</td>
</tr>
<tr>
<td><strong><code>start_date</code></strong></td>
<td><code>str</code></td>
<td><code>&lt;typer.models.OptionInfo object at 0x17e292d00&gt;</code></td>
<td><em>No Content</em></td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>Finally, make the app executable from the command line</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

