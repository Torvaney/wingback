---

title: Understat-DB CLI


keywords: fastai
sidebar: home_sidebar

summary: "CLI for creating a soccer database with data from understat.com"
description: "CLI for creating a soccer database with data from understat.com"
nb_path: "nbs/cli.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/cli.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initialise the app with Typer</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EnvTyper" class="doc_header"><code>class</code> <code>EnvTyper</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L25" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EnvTyper</code>(<strong><code>name</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a6118d0&gt;</code></em>, <strong><code>invoke_without_command</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a627f98&gt;</code></em>, <strong><code>no_args_is_help</code></strong>:<code>Optional</code>[<code>bool</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a627da0&gt;</code></em>, <strong><code>subcommand_metavar</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a627fd0&gt;</code></em>, <strong><code>chain</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e048&gt;</code></em>, <strong><code>result_callback</code></strong>:<code>Optional</code>[<code>Callable</code>[<code>Ellipsis</code>, <code>Any</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e080&gt;</code></em>, <strong><code>context_settings</code></strong>:<code>Optional</code>[<code>Dict</code>[<code>Any</code>, <code>Any</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e0b8&gt;</code></em>, <strong><code>callback</code></strong>:<code>Optional</code>[<code>Callable</code>[<code>Ellipsis</code>, <code>Any</code>]]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e0f0&gt;</code></em>, <strong><code>help</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e128&gt;</code></em>, <strong><code>epilog</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e160&gt;</code></em>, <strong><code>short_help</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e198&gt;</code></em>, <strong><code>options_metavar</code></strong>:<code>str</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e1d0&gt;</code></em>, <strong><code>add_help_option</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e208&gt;</code></em>, <strong><code>hidden</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e240&gt;</code></em>, <strong><code>deprecated</code></strong>:<code>bool</code>=<em><code>&lt;typer.models.DefaultPlaceholder object at 0x12a62e278&gt;</code></em>, <strong><code>add_completion</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <code>Typer</code></p>
</blockquote>
<p>Just like typer.Typer, except it loads the environment with
<code>dotenv.load_dotenv</code> before executing any command.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Migrate">Migrate<a class="anchor-link" href="#Migrate"> </a></h2><p>Migrating the database</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="migrate" class="doc_header"><code>migrate</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>migrate</code>(<strong><code>interactive</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>Migrate database to the current schema (as defined in nbs/db.ipynb)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="dbt-runner">dbt runner<a class="anchor-link" href="#dbt-runner"> </a></h2><p>(Re-)build tables from base data using dbt (data-build-tool)'s (unsupported) python API</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_tables" class="doc_header"><code>build_tables</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L93" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_tables</code>(<strong><code>args</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x12a60d898&gt;</code></em>)</p>
</blockquote>
<p>Build tables from base data using dbt</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Ingest">Ingest<a class="anchor-link" href="#Ingest"> </a></h2><p>Ingest base understat data and build understat tables from base data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ingest" class="doc_header"><code>ingest</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L120" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ingest</code>(<strong><code>refresh</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>leagues</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x12a60d940&gt;</code></em>, <strong><code>seasons</code></strong>:<code>List</code>[<code>int</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x12a60dba8&gt;</code></em>)</p>
</blockquote>
<p>Ingest match and shot data from Understat.com</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Modelling">Modelling<a class="anchor-link" href="#Modelling"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="resimulate" class="doc_header"><code>resimulate</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L211" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>resimulate</code>(<strong><code>refresh</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>leagues</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x12a62ee10&gt;</code></em>, <strong><code>seasons</code></strong>:<code>List</code>[<code>int</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x12a62ee48&gt;</code></em>)</p>
</blockquote>
<p>Resimulate matches based on individual shot xGs</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="backtest" class="doc_header"><code>backtest</code><a href="https://github.com/torvaney/wingback/tree/master/wingback/cli.py#L264" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>backtest</code>(<strong><code>refresh</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>models</code></strong>:<code>List</code>[<code>str</code>]=<em><code>&lt;typer.models.OptionInfo object at 0x12a62eeb8&gt;</code></em>, <strong><code>league</code></strong>:<code>str</code>=<em><code>&lt;typer.models.OptionInfo object at 0x12a62eef0&gt;</code></em>, <strong><code>start_date</code></strong>:<code>str</code>=<em><code>&lt;typer.models.OptionInfo object at 0x12a62ef28&gt;</code></em>)</p>
</blockquote>
<p>Fit team strength model(s) and persist to database</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-b0411a06b981&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> 
<span class="ansi-green-intense-fg ansi-bold">      3</span> 
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span><span class="ansi-blue-fg">@</span>app<span class="ansi-blue-fg">.</span>command<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> def backtest(
<span class="ansi-green-intense-fg ansi-bold">      6</span>     refresh<span class="ansi-blue-fg">:</span> bool <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>

<span class="ansi-red-fg">NameError</span>: name &#39;app&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p>Finally, make the app executable from the command line</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

